# =============================================================================
# IBC Configuration File
# Charter & Stone Capital â€” The Crucible
# =============================================================================
#
# This file is mounted into the Gateway container.
# Reference: https://github.com/IbcAlpha/IBC/blob/master/resources/config.ini
#
# =============================================================================

# =============================================================================
# 1. Authentication Settings
# =============================================================================

# Credentials are passed via environment variables, not this file
IbLoginId=
IbPassword=

# Trading mode: paper or live (MUST match your credentials)
TradingMode=paper

# =============================================================================
# 2. Gateway Behavior Settings
# =============================================================================

# Accept incoming API connections automatically
# Container only exposes to localhost, so this is safe
AcceptIncomingConnectionAction=accept

# Allow trading without market data subscription
AllowBlindTrading=yes

# Auto-dismiss paper trading warning dialog
AcceptNonBrokerageAccountWarning=yes

# If another session exists, take over as primary
ExistingSessionDetectedAction=primary

# Keep Gateway window (not relevant in container, but set anyway)
MinimizeMainWindow=no

# Don't store settings on IBKR servers
StoreSettingsOnServer=no

# =============================================================================
# 3. API Settings
# =============================================================================

# Allow full API access (not read-only)
ReadOnlyLogin=no
ReadOnlyApi=no

# =============================================================================
# 4. Auto-Logoff/Restart Settings
# =============================================================================

# DISABLED: We manage restarts via Docker/scheduled task
# Gateway's internal restart doesn't clear memory as effectively
IbAutoClosedown=no
AutoLogoffTime=
AutoRestartTime=

# =============================================================================
# 5. Two-Factor Authentication Settings
# =============================================================================

# Exit on 2FA timeout (container restart policy handles retry)
ExitAfterSecondFactorAuthenticationTimeout=yes

# 2FA timeout in seconds
SecondFactorAuthenticationTimeout=180

# Attempt re-login after 2FA timeout
ReloginAfterSecondFactorAuthenticationTimeout=yes

# =============================================================================
# 6. Command Server Settings
# =============================================================================

# Disable IBC command server (not needed with Docker management)
CommandServerPort=0
BindAddress=127.0.0.1
ControlFrom=127.0.0.1

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
